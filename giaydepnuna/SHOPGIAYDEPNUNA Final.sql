Create database GIAYDEPNUNADOTNET

CREATE TABLE NHANVIEN(
IDNV NVARCHAR(15) NOT NULL PRIMARY KEY,
HOTEN NVARCHAR(40),
DCHI NVARCHAR(50),
SDT NVARCHAR(20),
NGSINH SMALLDATETIME,
NGVL SMALLDATETIME,
CHUCVU NVARCHAR(30),
)
insert into nhanvien
values('NV01','Nguyen Van A','Bac Giang','0339393167','2-2-2003','1-3-2023','Nhan Vien'),
	('NV02','Nguyen Van B','Ha Noi','0339393167','2-5-2003','7-3-2023','Nhan Vien')

select*from nhanvien
update nhanvien set hoten='huong',
dchi='bacging',sdt='0989876765',ngsinh='1-1-2022',ngvl='8-8-2023',chucvu='nv' where idnv=''


create table NGUOIDUNG(
IDNV NVARCHAR(15) NOT NULL FOREIGN KEY REFERENCES NHANVIEN(IDNV),
ACCOUNT NVARCHAR(30) NOT NULL,
PRIMARY KEY(IDNV, ACCOUNT),
PASSWORK NVARCHAR(30))

insert into nguoidung
values('NV01','huong','123'),
		('NV02','huong','111')
SELECT ACCOUNT,PASSWORK from nguoidung

CREATE TABLE LUONG(
IDNV NVARCHAR(15) NOT NULL FOREIGN KEY REFERENCES NHANVIEN(IDNV),
NGCONG INT,
LUONG MONEY,
THUONG MONEY,
THANG INT)
insert into luong values('NV01','26','5200000','300000','1'),
						('NV02','22','4200000','300000','1')

CREATE TABLE NHACUNGCAP(
IDNCC NVARCHAR(15) NOT NULL PRIMARY KEY,
TENNCC NVARCHAR(40),
DCHI NVARCHAR(50),
SDT NVARCHAR(20),
GHICHU NTEXT)
insert into nhacungcap values('NCC01','Nguyen Thi A','Thai Nguyen','0987676564','null'),
							('NCC02','Nguyen Thi B','Bac Giang','0987676564','null')
							select* from nhacungcap where tenNCC like '%B%'

CREATE TABLE GIAYDEP(
IDSP NVARCHAR(15) NOT NULL PRIMARY KEY,
TENSP NVARCHAR(40),
SOLUONG INT,
LOAI NVARCHAR(25),
KICHCO INT,
GHICHU NTEXT,
GIA MONEY,
IDNCC NVARCHAR(15) FOREIGN KEY REFERENCES NHACUNGCAP(IDNCC)) 
insert into giaydep values('SP01','Nike','100','L1','38','Null','800000','NCC01'),
							('SP02','Nike','100','L2','38','Null','500000','NCC01'),
							('SP03','Nike','100','L3','38','Null','200000','NCC01')
							select*from giaydep
update giaydep set tensp='Jodan',soluong='50',loai='L1',kichco='40',ghichu='Null',gia='1000000',idncc='NCC02' where idsp='SP02'
select *from giaydep where idsp  like '%3%'

CREATE TABLE HOADON(
IDHD NVARCHAR(15) NOT NULL PRIMARY KEY,
IDNV NVARCHAR(15) FOREIGN KEY REFERENCES NHANVIEN(IDNV),
NGLAP SMALLDATETIME,
TRIGIA MONEY)
insert into hoadon values('HD01','NV01','5-9-2023','2000000'),
						('HD02','NV02','4-9-2023','1000000')

CREATE TABLE CTHOADON(
IDHD NVARCHAR(15) NOT NULL FOREIGN KEY REFERENCES HOADON(IDHD),
IDSP NVARCHAR(15) NOT NULL FOREIGN KEY REFERENCES GIAYDEP(IDSP),
PRIMARY KEY(IDHD, IDSP),
SOLUONG INT,
THANHTIEN MONEY)
insert into CTHOADON values('HD01','SP01','5','4000000'),
							('HD02','SP02','5','3000000')
					

CREATE TABLE PHIEUNHAPKHO(
IDPNK NVARCHAR(15) NOT NULL PRIMARY KEY,
NGLAP SMALLDATETIME,
IDNV nvarchar(15) FOREIGN KEY REFERENCES nhanvien(IDNV))
insert into phieunhapkho values('PN03','1-1-2023','NV01')
insert into phieunhapkho values('PN01','1-1-2023','NV01'),('PN02','1-1-2023','NV01')
								
CREATE TABLE CTPHIEUNHAPKHO(
IDPNK NVARCHAR(15) NOT NULL FOREIGN KEY REFERENCES PHIEUNHAPKHO(IDPNK),
IDSP NVARCHAR(15) NOT NULL FOREIGN KEY REFERENCES GIAYDEP(IDSP),
PRIMARY KEY(IDPNK, IDSP),
SOLUONG INT,
DONGIA float,
IDNCC nvarchar(15) not null foreign key references nhacungcap(idncc))
insert into ctphieunhapkho values('PN01','SP01','100','200000','ncc01'),
('PN02','SP02','2','100000','ncc02')
select*from CTPHIEUNHAPKHO
insert into CTPHIEUNHAPKHO values ('PN03','SP02','50','100000','ncc01')

SELECT PHIEUNHAPKHO.IDPNK, nglap,CTPHIEUNHAPKHO .soluong * CTPHIEUNHAPKHO.dongia AS thanhtien
FROM PHIEUNHAPKHO,CTPHIEUNHAPKHO,giaydep
where CTPHIEUNHAPKHO.IDPNK=PHIEUNHAPKHO.IDPNK
and CTPHIEUNHAPKHO.IDSP = giaydep.IDSP ;